name: continuos integration

on:
  push:
    branches:
      - test-ci
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  display:
      name: PR information
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/git.yaml@test-ci
  summary:
    name: Warning
    runs-on: ubuntu-latest
    steps:
      - name: Summary
        run: |
          echo '### Fique atento em caso de erro em qualquer job! ⚠️' >> $GITHUB_STEP_SUMMARY
          echo 'Além disso, por favor, verifique minuciosamente os logs dentro do job. 📝💻' >> $GITHUB_STEP_SUMMARY
  build:
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/build.yaml@test-ci
  test:
      needs: build
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/test.yaml@test-ci
  coverage:
      needs: test
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/coverage.yaml@test-ci
  analysis:
      needs: test
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/analysis.yaml@test-ci
  docker_build:
      needs: test
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/build_docker.yaml@test-ci
  publish:
      needs: [analysis, coverage, docker_build, check_versions]
      if: github.ref == 'refs/heads/main'
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/publish_docker.yaml@test-ci
  check_versions:
      uses: macgii/Teste-Contas-Bancarias/.github/workflows/check_versions.yaml@test-ci
      with:
          token: github.token